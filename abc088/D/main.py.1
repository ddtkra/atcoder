#!/usr/bin/env python3



# Generated by 1.1.4 https://github.com/kyuridenamida/atcoder-tools  (tips: You use the default template now. You can remove this line by using your custom template)
def main():
    # Failed to predict input format
    INF = 10000000

    H,W = map(int,input().split())
    maze = [input() for i in range(H)]

    d = [[INF]*W for i in range(H)]

    from collections import deque
    q = deque()

    q.appendleft([0,0])
    d[0][0] = 0

    dx = [[-1,0], [1,0], [0,1], [0,-1]]

    while(len(q)):
        i,j = q.pop()

        for di,dj in dx:
            if(0 <= i+di < H and 0 <= j+dj < W and d[i+di][j+dj] == INF and maze[i+di][j+dj] == '.'):
                q.appendleft([i+di,j+dj])
                d[i+di][j+dj] = d[i][j]+1

    # print(d[H-1][W-1])
    if(d[H-1][W-1] == INF):
        print(-1)
    else:
        print(sum([i.count('.') for i in maze]) - d[H-1][W-1] - 1)

if __name__ == '__main__':
    main()
